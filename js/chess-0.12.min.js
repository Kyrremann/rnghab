var Chess=function(e){var r="b",n="w",t=-1,o="p",i="n",f="b",u="r",a="q",l="k",c="pnbrqkPNBRQK",s="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",p=["1-0","0-1","1/2-1/2","*"],v={b:[16,32,17,15],w:[-16,-32,-17,-15]},h={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},g=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],d=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],E={p:0,n:1,b:2,r:3,q:4,k:5},m={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},b={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},_=7,A=6,C=1,y=0,S={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},I={w:[{square:S.a1,flag:b.QSIDE_CASTLE},{square:S.h1,flag:b.KSIDE_CASTLE}],b:[{square:S.a8,flag:b.QSIDE_CASTLE},{square:S.h8,flag:b.KSIDE_CASTLE}]},T=new Array(128),w={w:t,b:t},P=n,R={w:0,b:0},L=t,N=0,O=1,k=[],q={},D={};function Q(e){void 0===e&&(e=!1),T=new Array(128),w={w:t,b:t},P=n,R={w:0,b:0},L=t,N=0,O=1,k=[],e||(q={}),D={},M($())}function K(){for(var e=[],r={},n=function(e){e in D&&(r[e]=D[e])};k.length>0;)e.push(oe());for(n($());e.length>0;)te(e.pop()),n($());D=r}function U(){x(s)}function x(e,o){void 0===o&&(o=!1);var i=e.split(/\s+/),f=i[0],u=0;if(!j(e).valid)return!1;Q(o);for(var a=0;a<f.length;a++){var l=f.charAt(a);if("/"===l)u+=8;else if(-1!=="0123456789".indexOf(l))u+=parseInt(l,10);else{var c=l<"a"?n:r;G({type:l.toLowerCase(),color:c},ae(u)),u++}}return P=i[1],i[2].indexOf("K")>-1&&(R.w|=b.KSIDE_CASTLE),i[2].indexOf("Q")>-1&&(R.w|=b.QSIDE_CASTLE),i[2].indexOf("k")>-1&&(R.b|=b.KSIDE_CASTLE),i[2].indexOf("q")>-1&&(R.b|=b.QSIDE_CASTLE),L="-"===i[3]?t:S[i[3]],N=parseInt(i[4],10),O=parseInt(i[5],10),M($()),!0}function j(e){var r="No errors.",n="FEN string must contain six space-delimited fields.",t="6th field (move number) must be a positive integer.",o="5th field (half move counter) must be a non-negative integer.",i="4th field (en-passant square) is invalid.",f="3rd field (castling availability) is invalid.",u="2nd field (side to move) is invalid.",a="1st field (piece positions) does not contain 8 '/'-delimited rows.",l="1st field (piece positions) is invalid [consecutive numbers].",c="1st field (piece positions) is invalid [invalid piece].",s="1st field (piece positions) is invalid [row too large].",p="Illegal en-passant square",v=e.split(/\s+/);if(6!==v.length)return{valid:!1,error_number:1,error:n};if(isNaN(v[5])||parseInt(v[5],10)<=0)return{valid:!1,error_number:2,error:t};if(isNaN(v[4])||parseInt(v[4],10)<0)return{valid:!1,error_number:3,error:o};if(!/^(-|[abcdefgh][36])$/.test(v[3]))return{valid:!1,error_number:4,error:i};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(v[2]))return{valid:!1,error_number:5,error:f};if(!/^(w|b)$/.test(v[1]))return{valid:!1,error_number:6,error:u};var h=v[0].split("/");if(8!==h.length)return{valid:!1,error_number:7,error:a};for(var g=0;g<h.length;g++){for(var d=0,E=!1,m=0;m<h[g].length;m++)if(isNaN(h[g][m])){if(!/^[prnbqkPRNBQK]$/.test(h[g][m]))return{valid:!1,error_number:9,error:c};d+=1,E=!1}else{if(E)return{valid:!1,error_number:8,error:l};d+=parseInt(h[g][m],10),E=!0}if(8!==d)return{valid:!1,error_number:10,error:s}}return"3"==v[3][1]&&"w"==v[1]||"6"==v[3][1]&&"b"==v[1]?{valid:!1,error_number:11,error:p}:{valid:!0,error_number:0,error:r}}function $(){for(var e=0,o="",i=S.a8;i<=S.h1;i++){if(null==T[i])e++;else{e>0&&(o+=e,e=0);var f=T[i].color,u=T[i].type;o+=f===n?u.toUpperCase():u.toLowerCase()}i+1&136&&(e>0&&(o+=e),i!==S.h1&&(o+="/"),e=0,i+=8)}var a="";R[n]&b.KSIDE_CASTLE&&(a+="K"),R[n]&b.QSIDE_CASTLE&&(a+="Q"),R[r]&b.KSIDE_CASTLE&&(a+="k"),R[r]&b.QSIDE_CASTLE&&(a+="q"),a=a||"-";var l=L===t?"-":ae(L);return[o,P,a,l,N,O].join(" ")}function B(e){for(var r=0;r<e.length;r+=2)"string"==typeof e[r]&&"string"==typeof e[r+1]&&(q[e[r]]=e[r+1]);return q}function M(e){k.length>0||(e!==s?(q.SetUp="1",q.FEN=e):(delete q.SetUp,delete q.FEN))}function W(e){var r=T[S[e]];return r?{type:r.type,color:r.color}:null}function G(e,r){if(!("type"in e&&"color"in e))return!1;if(-1===c.indexOf(e.type.toLowerCase()))return!1;if(!(r in S))return!1;var n=S[r];return(e.type!=l||w[e.color]==t||w[e.color]==n)&&(T[n]={type:e.type,color:e.color},e.type===l&&(w[e.color]=n),M($()),!0)}function F(e,r,n,t,i){var f={color:P,from:r,to:n,flags:t,piece:e[r].type};return i&&(f.flags|=b.PROMOTION,f.promotion=i),e[n]?f.captured=e[n].type:t&b.EP_CAPTURE&&(f.captured=o),f}function H(e){function r(e,r,n,t,l){if(e[n].type!==o||fe(t)!==y&&fe(t)!==_)r.push(F(e,n,t,l));else for(var c=[a,u,f,i],s=0,p=c.length;s<p;s++)r.push(F(e,n,t,l,c[s]))}var n=[],t=P,c=le(t),s={b:C,w:A},p=S.a8,g=S.h1,d=!1,E=!(void 0!==e&&"legal"in e)||e.legal,m=!(void 0!==e&&"piece"in e&&"string"==typeof e.piece)||e.piece.toLowerCase();if(void 0!==e&&"square"in e){if(!(e.square in S))return[];p=g=S[e.square],d=!0}for(var I=p;I<=g;I++)if(136&I)I+=7;else{var N=T[I];if(null!=N&&N.color===t)if(N.type!==o||!0!==m&&m!==o){if(!0===m||m===N.type)for(var O=0,k=h[N.type].length;O<k;O++){var q=h[N.type][O];for(D=I;!(136&(D+=q));){if(null!=T[D]){if(T[D].color===t)break;r(T,n,I,D,b.CAPTURE);break}if(r(T,n,I,D,b.NORMAL),"n"===N.type||"k"===N.type)break}}}else{var D=I+v[t][0];if(null==T[D]){r(T,n,I,D,b.NORMAL);var D=I+v[t][1];s[t]===fe(I)&&null==T[D]&&r(T,n,I,D,b.BIG_PAWN)}for(O=2;O<4;O++){136&(D=I+v[t][O])||(null!=T[D]&&T[D].color===c?r(T,n,I,D,b.CAPTURE):D===L&&r(T,n,I,L,b.EP_CAPTURE))}}}if(!(!0!==m&&m!==l||d&&g!==w[t])){if(R[t]&b.KSIDE_CASTLE){var Q=(K=w[t])+2;null!=T[K+1]||null!=T[Q]||J(c,w[t])||J(c,K+1)||J(c,Q)||r(T,n,w[t],Q,b.KSIDE_CASTLE)}if(R[t]&b.QSIDE_CASTLE){var K;Q=(K=w[t])-2;null!=T[K-1]||null!=T[K-2]||null!=T[K-3]||J(c,w[t])||J(c,K-1)||J(c,Q)||r(T,n,w[t],Q,b.QSIDE_CASTLE)}}if(!E)return n;var U=[];for(I=0,k=n.length;I<k;I++)te(n[I]),V(t)||U.push(n[I]),oe();return U}function Z(e,r){var n="";if(e.flags&b.KSIDE_CASTLE)n="O-O";else if(e.flags&b.QSIDE_CASTLE)n="O-O-O";else{if(e.piece!==o){var t=function(e,r){for(var n=e.from,t=e.to,o=e.piece,i=0,f=0,u=0,a=0,l=r.length;a<l;a++){var c=r[a].from,s=r[a].to,p=r[a].piece;o===p&&n!==c&&t===s&&(i++,fe(n)===fe(c)&&f++,ue(n)===ue(c)&&u++)}if(i>0)return f>0&&u>0?ae(n):u>0?ae(n).charAt(1):ae(n).charAt(0);return""}(e,r);n+=e.piece.toUpperCase()+t}e.flags&(b.CAPTURE|b.EP_CAPTURE)&&(e.piece===o&&(n+=ae(e.from)[0]),n+="x"),n+=ae(e.to),e.flags&b.PROMOTION&&(n+="="+e.promotion.toUpperCase())}return te(e),X()&&(Y()?n+="#":n+="+"),oe(),n}function z(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function J(e,t){for(var i=S.a8;i<=S.h1;i++)if(136&i)i+=7;else if(null!=T[i]&&T[i].color===e){var f=T[i],u=i-t,a=u+119;if(g[a]&1<<E[f.type]){if(f.type===o){if(u>0){if(f.color===n)return!0}else if(f.color===r)return!0;continue}if("n"===f.type||"k"===f.type)return!0;for(var l=d[a],c=i+l,s=!1;c!==t;){if(null!=T[c]){s=!0;break}c+=l}if(!s)return!0}}return!1}function V(e){return J(le(e),w[e])}function X(){return V(P)}function Y(){return X()&&0===H().length}function ee(){return!X()&&0===H().length}function re(){for(var e={},r=[],n=0,t=0,o=S.a8;o<=S.h1;o++)if(t=(t+1)%2,136&o)o+=7;else{var u=T[o];u&&(e[u.type]=u.type in e?e[u.type]+1:1,u.type===f&&r.push(t),n++)}if(2===n)return!0;if(3===n&&(1===e[f]||1===e[i]))return!0;if(n===e[f]+2){var a=0,l=r.length;for(o=0;o<l;o++)a+=r[o];if(0===a||a===l)return!0}return!1}function ne(){for(var e=[],r={},n=!1;;){var t=oe();if(!t)break;e.push(t)}for(;;){var o=$().split(" ").slice(0,4).join(" ");if(r[o]=o in r?r[o]+1:1,r[o]>=3&&(n=!0),!e.length)break;te(e.pop())}return n}function te(e){var n=P,i=le(n);if(function(e){k.push({move:e,kings:{b:w.b,w:w.w},turn:P,castling:{b:R.b,w:R.w},ep_square:L,half_moves:N,move_number:O})}(e),T[e.to]=T[e.from],T[e.from]=null,e.flags&b.EP_CAPTURE&&(P===r?T[e.to-16]=null:T[e.to+16]=null),e.flags&b.PROMOTION&&(T[e.to]={type:e.promotion,color:n}),T[e.to].type===l){if(w[T[e.to].color]=e.to,e.flags&b.KSIDE_CASTLE){var f=e.to-1,u=e.to+1;T[f]=T[u],T[u]=null}else if(e.flags&b.QSIDE_CASTLE){f=e.to+1,u=e.to-2;T[f]=T[u],T[u]=null}R[n]=""}if(R[n])for(var a=0,c=I[n].length;a<c;a++)if(e.from===I[n][a].square&&R[n]&I[n][a].flag){R[n]^=I[n][a].flag;break}if(R[i])for(a=0,c=I[i].length;a<c;a++)if(e.to===I[i][a].square&&R[i]&I[i][a].flag){R[i]^=I[i][a].flag;break}L=e.flags&b.BIG_PAWN?"b"===P?e.to-16:e.to+16:t,e.piece===o?N=0:e.flags&(b.CAPTURE|b.EP_CAPTURE)?N=0:N++,P===r&&O++,P=le(P)}function oe(){var e=k.pop();if(null==e)return null;var n=e.move;w=e.kings,P=e.turn,R=e.castling,L=e.ep_square,N=e.half_moves,O=e.move_number;var t,i,f=P,u=le(P);if(T[n.from]=T[n.to],T[n.from].type=n.piece,T[n.to]=null,n.flags&b.CAPTURE)T[n.to]={type:n.captured,color:u};else if(n.flags&b.EP_CAPTURE){var a;a=f===r?n.to-16:n.to+16,T[a]={type:o,color:u}}n.flags&(b.KSIDE_CASTLE|b.QSIDE_CASTLE)&&(n.flags&b.KSIDE_CASTLE?(t=n.to+1,i=n.to-1):n.flags&b.QSIDE_CASTLE&&(t=n.to-2,i=n.to+1),T[t]=T[i],T[i]=null);return n}function ie(e,r){var n=z(e),t=!1;if(r)if(c=n.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/)){var i=c[1],f=c[2],u=c[3],a=c[4];1==f.length&&(t=!0)}else{var c;if(c=n.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/)){i=c[1],f=c[2],u=c[3],a=c[4];if(1==f.length)t=!0}}for(var s=function(e){var r=e.charAt(0);if(r>="a"&&r<="h"){if(e.match(/[a-h]\d.*[a-h]\d/))return;return o}return"o"===(r=r.toLowerCase())?l:r}(n),p=H({legal:!0,piece:i||s}),v=0,h=p.length;v<h;v++){if(n===z(Z(p[v],p)))return p[v];if(r&&c){if(!(i&&i.toLowerCase()!=p[v].piece||S[f]!=p[v].from||S[u]!=p[v].to||a&&a.toLowerCase()!=p[v].promotion))return p[v];if(t){var g=ae(p[v].from);if(!(i&&i.toLowerCase()!=p[v].piece||S[u]!=p[v].to||f!=g[0]&&f!=g[1]||a&&a.toLowerCase()!=p[v].promotion))return p[v]}}}return null}function fe(e){return e>>4}function ue(e){return 15&e}function ae(e){var r=ue(e),n=fe(e);return"abcdefgh".substring(r,r+1)+"87654321".substring(n,n+1)}function le(e){return e===n?r:n}function ce(e){var r=function e(r){var n=r instanceof Array?[]:{};for(var t in r)n[t]="object"==typeof t?e(r[t]):r[t];return n}(e);r.san=Z(r,H({legal:!0})),r.to=ae(r.to),r.from=ae(r.from);var n="";for(var t in b)b[t]&r.flags&&(n+=m[t]);return r.flags=n,r}function se(e){return e.replace(/^\s+|\s+$/g,"")}return x(void 0===e?s:e),{WHITE:n,BLACK:r,PAWN:o,KNIGHT:i,BISHOP:f,ROOK:u,QUEEN:a,KING:l,SQUARES:function(){for(var e=[],r=S.a8;r<=S.h1;r++)136&r?r+=7:e.push(ae(r));return e}(),FLAGS:m,load:function(e){return x(e)},reset:function(){return U()},moves:function(e){for(var r=H(e),n=[],t=0,o=r.length;t<o;t++)void 0!==e&&"verbose"in e&&e.verbose?n.push(ce(r[t])):n.push(Z(r[t],H({legal:!0})));return n},in_check:function(){return X()},in_checkmate:function(){return Y()},in_stalemate:function(){return ee()},in_draw:function(){return N>=100||ee()||re()||ne()},insufficient_material:function(){return re()},in_threefold_repetition:function(){return ne()},game_over:function(){return N>=100||Y()||ee()||re()||ne()},validate_fen:function(e){return j(e)},fen:function(){return $()},board:function(){for(var e=[],r=[],n=S.a8;n<=S.h1;n++)null==T[n]?r.push(null):r.push({type:T[n].type,color:T[n].color}),n+1&136&&(e.push(r),r=[],n+=8);return e},pgn:function(e){var r="object"==typeof e&&"string"==typeof e.newline_char?e.newline_char:"\n",n="object"==typeof e&&"number"==typeof e.max_width?e.max_width:0,t=[],o=!1;for(var i in q)t.push("["+i+' "'+q[i]+'"]'+r),o=!0;o&&k.length&&t.push(r);for(var f=function(e){var r=D[$()];void 0!==r&&(e=`${e}${e.length>0?" ":""}{${r}}`);return e},u=[];k.length>0;)u.push(oe());var a=[],l="";for(0===u.length&&a.push(f(""));u.length>0;){l=f(l);var c=u.pop();k.length||"b"!==c.color?"w"===c.color&&(l.length&&a.push(l),l=O+"."):l=O+". ...",l=l+" "+Z(c,H({legal:!0})),te(c)}if(l.length&&a.push(f(l)),void 0!==q.Result&&a.push(q.Result),0===n)return t.join("")+a.join(" ");var s=function(){return t.length>0&&" "===t[t.length-1]&&(t.pop(),!0)},p=function(e,o){for(var i of o.split(" "))if(i){if(e+i.length>n){for(;s();)e--;t.push(r),e=0}t.push(i),e+=i.length,t.push(" "),e++}return s()&&e--,e},v=0;for(i=0;i<a.length;i++)v+a[i].length>n&&a[i].includes("{")?v=p(v,a[i]):(v+a[i].length>n&&0!==i?(" "===t[t.length-1]&&t.pop(),t.push(r),v=0):0!==i&&(t.push(" "),v++),t.push(a[i]),v+=a[i].length);return t.join("")},load_pgn:function(e,r){var n=void 0!==r&&"sloppy"in r&&r.sloppy;function t(e){return e.replace(/\\/g,"\\")}var o="object"==typeof r&&"string"==typeof r.newline_char?r.newline_char:"\r?\n",i=new RegExp("^(\\[((?:"+t(o)+")|.)*\\])(?:"+t(o)+"){2}"),f=i.test(e)?i.exec(e)[1]:"";U();var u=function(e,r){for(var n="object"==typeof r&&"string"==typeof r.newline_char?r.newline_char:"\r?\n",o={},i=e.split(new RegExp(t(n))),f="",u="",a=0;a<i.length;a++)f=i[a].replace(/^\[([A-Z][A-Za-z]*)\s.*\]$/,"$1"),u=i[a].replace(/^\[[A-Za-z]+\s"(.*)"\ *\]$/,"$1"),se(f).length>0&&(o[f]=u);return o}(f,r);for(var a in u)B([a,u[a]]);if("1"===u.SetUp&&!("FEN"in u&&x(u.FEN,!0)))return!1;for(var l=function(e){return`{${function(e){return Array.from(e).map(function(e){return e.charCodeAt(0)<128?e.charCodeAt(0).toString(16):encodeURIComponent(e).replace(/\%/g,"").toLowerCase()}).join("")}((e=e.replace(new RegExp(t(o),"g")," ")).slice(1,e.length-1))}}`},c=function(e){if(e.startsWith("{")&&e.endsWith("}"))return function(e){return 0==e.length?"":decodeURIComponent("%"+e.match(/.{1,2}/g).join("%"))}(e.slice(1,e.length-1))},s=e.replace(f,"").replace(new RegExp(`({[^}]*})+?|;([^${t(o)}]*)`,"g"),function(e,r,n){return void 0!==r?l(r):" "+l(`{${n.slice(1)}}`)}).replace(new RegExp(t(o),"g")," "),v=/(\([^\(\)]+\))+?/g;v.test(s);)s=s.replace(v,"");var h=se(s=(s=(s=s.replace(/\d+\.(\.\.)?/g,"")).replace(/\.\.\./g,"")).replace(/\$\d+/g,"")).split(new RegExp(/\s+/));h=h.join(",").replace(/,,+/g,",").split(",");for(var g="",d="",E=0;E<h.length;E++){var m=c(h[E]);if(void 0===m)if(null==(g=ie(h[E],n))){if(!(p.indexOf(h[E])>-1))return!1;d=h[E]}else d="",te(g);else D[$()]=m}return d&&Object.keys(q).length&&!q.Result&&B(["Result",d]),!0},header:function(){return B(arguments)},ascii:function(){return function(){for(var e="   +------------------------+\n",r=S.a8;r<=S.h1;r++){if(0===ue(r)&&(e+=" "+"87654321"[fe(r)]+" |"),null==T[r])e+=" . ";else{var t=T[r].type;e+=" "+(T[r].color===n?t.toUpperCase():t.toLowerCase())+" "}r+1&136&&(e+="|\n",r+=8)}return e+="   +------------------------+\n",e+="     a  b  c  d  e  f  g  h\n"}()},turn:function(){return P},move:function(e,r){var n=void 0!==r&&"sloppy"in r&&r.sloppy,t=null;if("string"==typeof e)t=ie(e,n);else if("object"==typeof e)for(var o=H(),i=0,f=o.length;i<f;i++)if(!(e.from!==ae(o[i].from)||e.to!==ae(o[i].to)||"promotion"in o[i]&&e.promotion!==o[i].promotion)){t=o[i];break}if(!t)return null;var u=ce(t);return te(t),u},undo:function(){var e=oe();return e?ce(e):null},clear:function(){return Q()},put:function(e,r){return G(e,r)},get:function(e){return W(e)},remove:function(e){return function(e){var r=W(e);return T[S[e]]=null,r&&r.type===l&&(w[r.color]=t),M($()),r}(e)},perft:function(e){return function e(r){for(var n=H({legal:!1}),t=0,o=P,i=0,f=n.length;i<f;i++)te(n[i]),V(o)||(r-1>0?t+=e(r-1):t++),oe();return t}(e)},square_color:function(e){if(e in S){var r=S[e];return(fe(r)+ue(r))%2==0?"light":"dark"}return null},history:function(e){for(var r=[],n=[],t=(void 0!==e&&"verbose"in e&&e.verbose);k.length>0;)r.push(oe());for(;r.length>0;){var o=r.pop();t?n.push(ce(o)):n.push(Z(o,H({legal:!0}))),te(o)}return n},get_comment:function(){return D[$()]},set_comment:function(e){D[$()]=e.replace("{","[").replace("}","]")},delete_comment:function(){var e=D[$()];return delete D[$()],e},get_comments:function(){return K(),Object.keys(D).map(function(e){return{fen:e,comment:D[e]}})},delete_comments:function(){return K(),Object.keys(D).map(function(e){var r=D[e];return delete D[e],{fen:e,comment:r}})}}};"undefined"!=typeof exports&&(exports.Chess=Chess),"undefined"!=typeof define&&define(function(){return Chess});
